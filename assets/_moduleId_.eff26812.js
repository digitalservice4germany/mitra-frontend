import{R as X,s as D}from"./button.esm.d458c792.js";import{Z as z,J as y,r as F,L as j,o as r,c as m,k as C,F as M,x as W,M as U,j as c,t as O,n as k,N as q,Q as Z,p as J,T as Q,g as B,q as I,h as g,i as d,a4 as V,X as A,u as v,aa as $,l as R,a9 as G}from"./vendor.6983a0d7.js";import{R as K,T,u as ee}from"./main.57b2b96b.js";import{b as te}from"./provide.891e7d0e.js";import{_ as ne}from"./Breadcrumb.7c6cfbeb.js";import{b as N,_ as se}from"./SideMenu.213c6586.js";import{s as ie}from"./dropdown.esm.90bb0229.js";var H={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,t){if(this.disabled(t)){e.preventDefault();return}this.activeItem=t},onItemClick(e,t,s){if(this.disabled(t)){e.preventDefault();return}t.command&&t.command({originalEvent:e,item:t}),t.items&&(this.activeItem&&t===this.activeItem?this.activeItem=null:this.activeItem=t),t.items||this.onLeafClick(),t.to&&s&&s(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,t=y.getOffset(this.$refs.container.parentElement),s=y.getViewport(),a=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:y.getHiddenElementOuterWidth(this.$refs.container),o=y.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(t.left,10)+o+a>s.width-y.calculateScrollbarWidth()?this.$refs.container.style.left=-1*a+"px":this.$refs.container.style.left=o+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:X}};const le={class:"p-menuitem-text"},ae={class:"p-menuitem-text"},oe={key:0,class:"p-submenu-icon pi pi-angle-right"};function re(e,t,s,a,o,n){const u=F("router-link"),_=F("ContextMenuSub",!0),b=j("ripple");return r(),m(Z,{name:"p-contextmenusub",onEnter:n.onEnter},{default:C(()=>[(s.root?!0:s.parentActive)?(r(),m("ul",{key:0,ref:"container",class:n.containerClass,role:"menu"},[(r(!0),m(M,null,W(s.model,(i,x)=>(r(),m(M,{key:n.label(i)+x.toString()},[n.visible(i)&&!i.separator?(r(),m("li",{key:0,role:"none",class:n.getItemClass(i),style:i.style,onMouseenter:h=>n.onItemMouseEnter(h,i)},[s.template?(r(),m(q(s.template),{key:1,item:i},null,8,["item"])):(r(),m(M,{key:0},[i.to&&!n.disabled(i)?(r(),m(u,{key:0,to:i.to,custom:""},{default:C(({navigate:h,href:L,isActive:S,isExactActive:w})=>[U(c("a",{href:L,onClick:l=>n.onItemClick(l,i,h),class:n.linkClass(i,{isActive:S,isExactActive:w}),role:"menuitem"},[c("span",{class:["p-menuitem-icon",i.icon]},null,2),c("span",le,O(n.label(i)),1)],10,["href","onClick"]),[[b]])]),_:2},1032,["to"])):U((r(),m("a",{key:1,href:i.url,class:n.linkClass(i),target:i.target,onClick:h=>n.onItemClick(h,i),"aria-haspopup":i.items!=null,"aria-expanded":i===o.activeItem,role:"menuitem",tabindex:n.disabled(i)?null:"0"},[c("span",{class:["p-menuitem-icon",i.icon]},null,2),c("span",ae,O(n.label(i)),1),i.items?(r(),m("span",oe)):k("",!0)],10,["href","target","onClick","aria-haspopup","aria-expanded","tabindex"])),[[b]])],64)),n.visible(i)&&i.items?(r(),m(_,{model:i.items,key:n.label(i)+"_sub_",template:s.template,onLeafClick:n.onLeafClick,parentActive:i===o.activeItem,exact:s.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):k("",!0)],46,["onMouseenter"])):k("",!0),n.visible(i)&&i.separator?(r(),m("li",{class:["p-menu-separator",i.class],style:i.style,key:"separator"+x.toString(),role:"separator"},null,6)):k("",!0)],64))),128))],2)):k("",!0)]),_:1},8,["onEnter"])}H.render=re;var Y={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&z.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const t=e.item;t.command&&(t.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&z.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&z.clear(e)},position(){let e=this.pageX+1,t=this.pageY+1,s=this.container.offsetParent?this.container.offsetWidth:y.getHiddenElementOuterWidth(this.container),a=this.container.offsetParent?this.container.offsetHeight:y.getHiddenElementOuterHeight(this.container),o=y.getViewport();e+s-document.body.scrollLeft>o.width&&(e-=s),t+a-document.body.scrollTop>o.height&&(t-=a),e<document.body.scrollLeft&&(e=document.body.scrollLeft),t<document.body.scrollTop&&(t=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=t+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:H}};function ue(e,t,s,a,o,n){const u=F("ContextMenuSub");return r(),m(Q,{to:s.appendTo},[c(Z,{name:"p-contextmenu",onEnter:n.onEnter,onLeave:n.onLeave,onAfterLeave:n.onAfterLeave},{default:C(()=>[o.visible?(r(),m("div",J({key:0,ref:n.containerRef,class:n.containerClass},e.$attrs),[c(u,{model:s.model,root:!0,onLeafClick:n.onLeafClick,template:e.$slots.item,exact:s.exact},null,8,["model","onLeafClick","template","exact"])],16)):k("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function de(e,t){t===void 0&&(t={});var s=t.insertAt;if(!(!e||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",s==="top"&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var ce=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;de(ce);Y.render=ue;const pe=["onKeypress"],me=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," more_vert ",-1),he=["onKeypress"],fe=d("header",{class:"text-slate-400"},"Antworttyp",-1),ve={class:"relative edit"},be={class:"mb-2"},ye=B({props:{step:null},emits:["addStep","duplicateStep","deleteStep","updateStep"],setup(e,{emit:t}){const s=e,a=I(!1),o=()=>a.value=!0,n=()=>a.value=!a.value,u=I(),_=[{label:"Neue Frage",command:()=>t("addStep")},{label:"Frage duplizieren",command:()=>t("duplicateStep")},{label:"Frage l\xF6schen",command:()=>t("deleteStep")}],b=l=>{u.value.show(l)},i={TextAnswerStep:"Kurzer Text",RichTextAnswerStep:"Langer Text"},x=Object.keys(i).map(l=>({modelValue:l,name:i[l]})),h=I(x.find(l=>l.modelValue===s.step.type)),L=l=>{t("updateStep",(()=>{const p=l.value.modelValue;if(p===K.TYPE)return new K(s.step.prompt,{description:s.step.description,id:s.step.id});if(p===T.TYPE)return new T(s.step.prompt,{description:s.step.description,id:s.step.id});throw new Error("Unknown step type")})())},S=l=>{const p=s.step;p.prompt=l,t("updateStep",p)},w=l=>{const p=s.step;p.description=l,t("updateStep",p)};return(l,p)=>(r(),g("div",{class:V([{open:a.value},"relative transition"])},[d("span",{class:V(["toggle-arrow absolute top-4 left-3 material-icons-outlined cursor-pointer text-2xl leading-9 transition select-none z-20",{"rotate-270":!a.value}]),"aria-label":"Fragendetails anzeigen",onClick:n,onKeypress:A(n,["o"])}," expand_more ",42,pe),c(v(D),{type:"button",class:"absolute top-5 right-5 z-20","aria-label":"menu","aria-haspopup":"menu",onContextmenu:b,onClick:b,onKeypress:A(b,["m"])},{default:C(()=>[me]),_:1},8,["onKeypress"]),c(v(Y),{ref_key:"menu",ref:u,model:_},null,512),d("header",{class:"edit relative py-2 pl-8",onClick:o,onKeypress:A(o,["o"])},[c(N,{editable:e.step.prompt,h1:"",onUpdate:S},null,8,["editable"]),d("div",{class:"antworttyp text-base py-2 ml-3",style:$([a.value?"display: none":""])},[fe,R(" "+O(i[e.step.type]),1)],4)],40,he),d("div",{class:"details pb-5 pl-8",style:$([a.value?"":"display: none"])},[d("div",ve,[d("div",be,[c(N,{editable:e.step.description,placeholder:"Erkl\xE4rungstext (optional)",onUpdate:w},null,8,["editable"])]),d("div",null,[c(v(ie),{modelValue:h.value,"onUpdate:modelValue":p[0]||(p[0]=f=>h.value=f),options:v(x),"option-label":"name",class:"ml-3","aria-label":"Fragentyp",placeholder:"Fragentyp ausw\xE4hlen",onChange:L},null,8,["modelValue","options"])])])],4)],2))}}),xe={class:"flex h-full"},ke={class:"flex-none"},ge={class:"flex-1 px-8"},Ce={class:"edit"},_e=d("p",null,[d("small",null,"Modul")],-1),Le=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," delete ",-1),Se=R(" Modul l\xF6schen "),we={class:"mt-16"},Ie=d("h2",{class:"font-bold text-lg"},"Fragen",-1),Ee={key:0},Me=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," add ",-1),Te=R(" Neue Frage "),ze={key:2},Ae=B({props:{playbookId:null,moduleId:null},setup(e){const t=e,s=ee(),a=G(),o=te(),n=I(s.playbook),u=I(n.value.findModuleById(t.moduleId)),_=l=>{u.value.title=l,s.refresh({playbook:n.value})},b=()=>{o.save(n.value)},i=async l=>{await a.push(`/mitra-frontend/playbook/${n.value.id}/module/${l.id}/`)},x=async()=>{n.value.removeModule(u.value),s.refresh({playbook:n.value}),await a.push(`/mitra-frontend/playbook/${n.value.id}/`)},h=l=>{l?u.value.addStep(new T("Neue Frage"),l):u.value.addStep(new T("Neue Frage")),s.refresh({playbook:n.value})},L=l=>{u.value.duplicateStep(l),s.refresh({playbook:n.value})},S=l=>{u.value.removeStep(l),s.refresh({playbook:n.value})},w=(l,p)=>{const f=u.value.steps.indexOf(l);u.value.steps[f]=p,s.refresh({playbook:n.value})};return(l,p)=>(r(),g("div",xe,[d("nav",ke,[c(se,{title:v(n).title,navigatable:v(n),onSave:b,onNavigate:i},null,8,["title","navigatable"])]),d("main",ge,[d("header",Ce,[c(ne,{"current-title":u.value.title,"parent-items":[v(n)]},null,8,["current-title","parent-items"]),_e,c(N,{editable:u.value.title,h1:"",button:"",onUpdate:_},null,8,["editable"]),c(v(D),{type:"button",class:"inline-flex align-top",onClick:x},{default:C(()=>[Le,Se]),_:1})]),d("section",we,[Ie,u.value.steps.length===0?(r(),g("p",Ee," F\xFCr dieses Modul wurden noch keine Fragen erstellt. ")):k("",!0),u.value.steps.length===0?(r(),m(v(D),{key:1,type:"button",class:"mt-8",onClick:p[0]||(p[0]=f=>h())},{default:C(()=>[Me,Te]),_:1})):(r(),g("ol",ze,[(r(!0),g(M,null,W(u.value.steps,(f,P)=>(r(),g("li",{key:f.id,class:"mt-4 border shadow-md"},[c(ye,{step:f,onAddStep:E=>h(P+1),onDeleteStep:E=>S(f),onDuplicateStep:E=>L(f),onUpdateStep:E=>w(f,E)},null,8,["step","onAddStep","onDeleteStep","onDuplicateStep","onUpdateStep"])]))),128))]))])])]))}}),Ve=B({props:{playbookId:null,moduleId:null},setup(e){return(t,s)=>(r(),m(Ae,{key:e.moduleId,"playbook-id":e.playbookId,"module-id":e.moduleId},null,8,["playbook-id","module-id"]))}});export{Ve as default};
