var h=Object.defineProperty;var p=(t,e,r)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var a=(t,e,r)=>(p(t,typeof e!="symbol"?e+"":e,r),r);import{n as u}from"./vendor.0137cc33.js";import{C as o,c as d,S as i,A as l}from"./JSONMapper.244643e1.js";class f extends l{constructor(){super("")}clone(){return this}toString(){return""}}const c=class extends i{constructor(){super("",new f)}get type(){return c.TYPE}clone(){return this}};let s=c;a(s,"TYPE","NullStep");class m extends o{constructor(){super("",[])}}const S=u("session",{state:()=>({cache:[new m,new s,{createdAt:new Date(0)}],entryPoint:""}),actions:{rememberContract(t,e){this.cache=[t,e||t.path[0],t.metadata]},rememberEntryPoint(t){this.entryPoint=t}},getters:{contract(){if(Reflect.getPrototypeOf(this.cache[0])===o.prototype)return this.cache[0];const{createdAt:t,savedAt:e}=JSON.parse(JSON.stringify(this.cache[2]||{}),(r,n)=>["createdAt","savedAt"].includes(r)?new Date(n):n);return d({contract:this.cache[0]}).updateMetadata({createdAt:t,savedAt:e})},lastEditedStep(){return Reflect.getPrototypeOf(this.cache[1])===i.prototype?this.cache[1]:this.contract.path.find(t=>t.id===this.cache[1].id)||new s}},persist:{enabled:!0}});export{S as u};
