import{R as V,s as A}from"./button.esm.fcff9ce8.js";import{Z as E,J as b,r as z,L as K,o as a,c as u,w as k,F as S,s as R,M as N,j as c,t as B,m as v,N as X,Q as U,p as Y,T as P,f as F,q as D,g as y,h as p,_ as j,u as x,a8 as q,k as W}from"./vendor.0137cc33.js";import{u as J,T as O}from"./session.de0901a5.js";import{b as Q}from"./provide.06bfa9c2.js";import{_ as G}from"./Breadcrumb.0d0849d1.js";import{b as T,_ as ee}from"./SideMenu.1b445da5.js";import"./main.fd4decb8.js";var Z={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,n){if(this.disabled(n)){e.preventDefault();return}this.activeItem=n},onItemClick(e,n,s){if(this.disabled(n)){e.preventDefault();return}n.command&&n.command({originalEvent:e,item:n}),n.items&&(this.activeItem&&n===this.activeItem?this.activeItem=null:this.activeItem=n),n.items||this.onLeafClick(),n.to&&s&&s(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,n=b.getOffset(this.$refs.container.parentElement),s=b.getViewport(),o=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:b.getHiddenElementOuterWidth(this.$refs.container),l=b.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(n.left,10)+l+o>s.width-b.calculateScrollbarWidth()?this.$refs.container.style.left=-1*o+"px":this.$refs.container.style.left=l+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,n){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":n&&n.isActive,"router-link-active-exact":this.exact&&n&&n.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:V}};const te={class:"p-menuitem-text"},ne={class:"p-menuitem-text"},ie={key:0,class:"p-submenu-icon pi pi-angle-right"};function se(e,n,s,o,l,t){const r=z("router-link"),_=z("ContextMenuSub",!0),h=K("ripple");return a(),u(U,{name:"p-contextmenusub",onEnter:t.onEnter},{default:k(()=>[(s.root?!0:s.parentActive)?(a(),u("ul",{key:0,ref:"container",class:t.containerClass,role:"menu"},[(a(!0),u(S,null,R(s.model,(i,g)=>(a(),u(S,{key:t.label(i)+g.toString()},[t.visible(i)&&!i.separator?(a(),u("li",{key:0,role:"none",class:t.getItemClass(i),style:i.style,onMouseenter:m=>t.onItemMouseEnter(m,i)},[s.template?(a(),u(X(s.template),{key:1,item:i},null,8,["item"])):(a(),u(S,{key:0},[i.to&&!t.disabled(i)?(a(),u(r,{key:0,to:i.to,custom:""},{default:k(({navigate:m,href:I,isActive:w,isExactActive:M})=>[N(c("a",{href:I,onClick:d=>t.onItemClick(d,i,m),class:t.linkClass(i,{isActive:w,isExactActive:M}),role:"menuitem"},[c("span",{class:["p-menuitem-icon",i.icon]},null,2),c("span",te,B(t.label(i)),1)],10,["href","onClick"]),[[h]])]),_:2},1032,["to"])):N((a(),u("a",{key:1,href:i.url,class:t.linkClass(i),target:i.target,onClick:m=>t.onItemClick(m,i),"aria-haspopup":i.items!=null,"aria-expanded":i===l.activeItem,role:"menuitem",tabindex:t.disabled(i)?null:"0"},[c("span",{class:["p-menuitem-icon",i.icon]},null,2),c("span",ne,B(t.label(i)),1),i.items?(a(),u("span",ie)):v("",!0)],10,["href","target","onClick","aria-haspopup","aria-expanded","tabindex"])),[[h]])],64)),t.visible(i)&&i.items?(a(),u(_,{model:i.items,key:t.label(i)+"_sub_",template:s.template,onLeafClick:t.onLeafClick,parentActive:i===l.activeItem,exact:s.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):v("",!0)],46,["onMouseenter"])):v("",!0),t.visible(i)&&i.separator?(a(),u("li",{class:["p-menu-separator",i.class],style:i.style,key:"separator"+g.toString(),role:"separator"},null,6)):v("",!0)],64))),128))],2)):v("",!0)]),_:1},8,["onEnter"])}Z.render=se;var $={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&E.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const n=e.item;n.command&&(n.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&E.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&E.clear(e)},position(){let e=this.pageX+1,n=this.pageY+1,s=this.container.offsetParent?this.container.offsetWidth:b.getHiddenElementOuterWidth(this.container),o=this.container.offsetParent?this.container.offsetHeight:b.getHiddenElementOuterHeight(this.container),l=b.getViewport();e+s-document.body.scrollLeft>l.width&&(e-=s),n+o-document.body.scrollTop>l.height&&(n-=o),e<document.body.scrollLeft&&(e=document.body.scrollLeft),n<document.body.scrollTop&&(n=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=n+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:Z}};function le(e,n,s,o,l,t){const r=z("ContextMenuSub");return a(),u(P,{to:s.appendTo},[c(U,{name:"p-contextmenu",onEnter:t.onEnter,onLeave:t.onLeave,onAfterLeave:t.onAfterLeave},{default:k(()=>[l.visible?(a(),u("div",Y({key:0,ref:t.containerRef,class:t.containerClass},e.$attrs),[c(r,{model:s.model,root:!0,onLeafClick:t.onLeafClick,template:e.$slots.item,exact:s.exact},null,8,["model","onLeafClick","template","exact"])],16)):v("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function ae(e,n){n===void 0&&(n={});var s=n.insertAt;if(!(!e||typeof document=="undefined")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",s==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var oe=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;ae(oe);$.render=le;const re={open:""},ue={class:"text-lg relative"},ce={class:"edit"},de=p("div",null,null,-1),pe=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," more_vert ",-1),he=F({props:{step:null},emits:["addStep","duplicateStep","deleteStep","updateStep"],setup(e,{emit:n}){const s=e,o=D(),l=[{label:"Neue Frage",command:()=>n("addStep")},{label:"Frage duplizieren",command:()=>n("duplicateStep")},{label:"Frage l\xF6schen",command:()=>n("deleteStep")}],t=h=>{o.value.show(h)},r=h=>{const i=s.step;i.prompt=h,n("updateStep",i)},_=h=>{const i=s.step;i.description=h,n("updateStep",i)};return(h,i)=>(a(),y("details",re,[p("summary",ue,[p("header",ce,[c(T,{editable:e.step.prompt,onUpdate:r},null,8,["editable"]),de,c(T,{editable:e.step.description,placeholder:"Erkl\xE4rungstext (optional)",onUpdate:_},null,8,["editable"]),c(x(A),{type:"button",class:"absolute top-0 right-0","aria-label":"menu","aria-haspopup":"menu",onContextmenu:t,onClick:t,onKeypress:j(t,["m"])},{default:k(()=>[pe]),_:1},8,["onKeypress"]),c(x($),{ref_key:"menu",ref:o,model:l},null,512)])])]))}}),me={class:"flex h-full"},fe={class:"flex-none"},be={class:"flex-1 px-8"},ve={class:"edit"},xe=p("p",null,[p("small",null,"Modul")],-1),ye=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," delete ",-1),ke=W(" Modul l\xF6schen "),_e={class:"mt-16"},ge=p("h2",{class:"font-bold text-lg"},"Fragen",-1),Ce={key:0},Le=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," add ",-1),Se=W(" Neue Frage "),Ie={key:2},we=F({props:{playbookId:null,moduleId:null},setup(e){const n=e,s=J(),o=q(),l=Q(),t=D(s.playbook),r=D(t.value.findModuleById(n.moduleId)),_=d=>{r.value.title=d,s.refresh({playbook:t.value})},h=()=>{l.save(t.value)},i=async d=>{await o.push(`/mitra-frontend/playbook/${t.value.id}/module/${d.id}/`)},g=async()=>{t.value.removeModule(r.value),s.refresh({playbook:t.value}),await o.push(`/mitra-frontend/playbook/${t.value.id}/`)},m=d=>{d?r.value.addStep(new O("Neue Frage"),d):r.value.addStep(new O("Neue Frage")),s.refresh({playbook:t.value})},I=d=>{r.value.duplicateStep(d),s.refresh({playbook:t.value})},w=d=>{r.value.removeStep(d),s.refresh({playbook:t.value})},M=(d,C)=>{const f=r.value.steps.indexOf(d);r.value.steps[f]=C,s.refresh({playbook:t.value})};return(d,C)=>(a(),y("div",me,[p("nav",fe,[c(ee,{title:x(t).title,navigatable:x(t),onSave:h,onNavigate:i},null,8,["title","navigatable"])]),p("main",be,[p("header",ve,[c(G,{"current-title":r.value.title,"parent-items":[x(t)]},null,8,["current-title","parent-items"]),xe,c(T,{editable:r.value.title,h1:"",button:"",onUpdate:_},null,8,["editable"]),c(x(A),{type:"button",class:"inline-flex align-top",onClick:g},{default:k(()=>[ye,ke]),_:1})]),p("section",_e,[ge,r.value.steps.length===0?(a(),y("p",Ce," F\xFCr dieses Modul wurden noch keine Fragen erstellt. ")):v("",!0),r.value.steps.length===0?(a(),u(x(A),{key:1,type:"button",class:"mt-8",onClick:C[0]||(C[0]=f=>m())},{default:k(()=>[Le,Se]),_:1})):(a(),y("ol",Ie,[(a(!0),y(S,null,R(r.value.steps,(f,H)=>(a(),y("li",{key:f.id,class:"mt-4 border p-4 shadow-md"},[c(he,{step:f,onAddStep:L=>m(H+1),onDeleteStep:L=>w(f),onDuplicateStep:L=>I(f),onUpdateStep:L=>M(f,L)},null,8,["step","onAddStep","onDeleteStep","onDuplicateStep","onUpdateStep"])]))),128))]))])])]))}}),Ne=F({props:{playbookId:null,moduleId:null},setup(e){return(n,s)=>(a(),u(we,{key:e.moduleId,"playbook-id":e.playbookId,"module-id":e.moduleId},null,8,["playbook-id","module-id"]))}});export{Ne as default};
