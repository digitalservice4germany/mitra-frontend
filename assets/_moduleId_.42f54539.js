import{Z as N,J as x,r as O,L as R,o,c,w as v,F as E,s as W,M,j as u,t as T,m as k,N as Q,Q as Z,p as G,T as ee,f as z,q as _,h as d,_ as V,u as h,a8 as te,g as C,a7 as ne,k as $}from"./vendor.0be2fb2e.js";import{R as ie,s as w}from"./button.esm.75cd8d93.js";import{s as H,b as P,_ as se}from"./SideMenu.dc186e6b.js";import{c as le,T as U,d as ae}from"./provide.4881203b.js";import{_ as oe}from"./Breadcrumb.3dff2f9c.js";import"./session.ab4c07a9.js";import"./Contract.6e826346.js";import"./main.c506771a.js";var X={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,n){if(this.disabled(n)){e.preventDefault();return}this.activeItem=n},onItemClick(e,n,l){if(this.disabled(n)){e.preventDefault();return}n.command&&n.command({originalEvent:e,item:n}),n.items&&(this.activeItem&&n===this.activeItem?this.activeItem=null:this.activeItem=n),n.items||this.onLeafClick(),n.to&&l&&l(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,n=x.getOffset(this.$refs.container.parentElement),l=x.getViewport(),s=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:x.getHiddenElementOuterWidth(this.$refs.container),a=x.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(n.left,10)+a+s>l.width-x.calculateScrollbarWidth()?this.$refs.container.style.left=-1*s+"px":this.$refs.container.style.left=a+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,n){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":n&&n.isActive,"router-link-active-exact":this.exact&&n&&n.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:ie}};const re={class:"p-menuitem-text"},ue={class:"p-menuitem-text"},ce={key:0,class:"p-submenu-icon pi pi-angle-right"};function de(e,n,l,s,a,t){const r=O("router-link"),m=O("ContextMenuSub",!0),p=R("ripple");return o(),c(Z,{name:"p-contextmenusub",onEnter:t.onEnter},{default:v(()=>[(l.root?!0:l.parentActive)?(o(),c("ul",{key:0,ref:"container",class:t.containerClass,role:"menu"},[(o(!0),c(E,null,W(l.model,(i,L)=>(o(),c(E,{key:t.label(i)+L.toString()},[t.visible(i)&&!i.separator?(o(),c("li",{key:0,role:"none",class:t.getItemClass(i),style:i.style,onMouseenter:y=>t.onItemMouseEnter(y,i)},[l.template?(o(),c(Q(l.template),{key:1,item:i},null,8,["item"])):(o(),c(E,{key:0},[i.to&&!t.disabled(i)?(o(),c(r,{key:0,to:i.to,custom:""},{default:v(({navigate:y,href:A,isActive:D,isExactActive:S})=>[M(u("a",{href:A,onClick:B=>t.onItemClick(B,i,y),class:t.linkClass(i,{isActive:D,isExactActive:S}),role:"menuitem"},[u("span",{class:["p-menuitem-icon",i.icon]},null,2),u("span",re,T(t.label(i)),1)],10,["href","onClick"]),[[p]])]),_:2},1032,["to"])):M((o(),c("a",{key:1,href:i.url,class:t.linkClass(i),target:i.target,onClick:y=>t.onItemClick(y,i),"aria-haspopup":i.items!=null,"aria-expanded":i===a.activeItem,role:"menuitem",tabindex:t.disabled(i)?null:"0"},[u("span",{class:["p-menuitem-icon",i.icon]},null,2),u("span",ue,T(t.label(i)),1),i.items?(o(),c("span",ce)):k("",!0)],10,["href","target","onClick","aria-haspopup","aria-expanded","tabindex"])),[[p]])],64)),t.visible(i)&&i.items?(o(),c(m,{model:i.items,key:t.label(i)+"_sub_",template:l.template,onLeafClick:t.onLeafClick,parentActive:i===a.activeItem,exact:l.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):k("",!0)],46,["onMouseenter"])):k("",!0),t.visible(i)&&i.separator?(o(),c("li",{class:["p-menu-separator",i.class],style:i.style,key:"separator"+L.toString(),role:"separator"},null,6)):k("",!0)],64))),128))],2)):k("",!0)]),_:1},8,["onEnter"])}X.render=de;var Y={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&N.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const n=e.item;n.command&&(n.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&N.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&N.clear(e)},position(){let e=this.pageX+1,n=this.pageY+1,l=this.container.offsetParent?this.container.offsetWidth:x.getHiddenElementOuterWidth(this.container),s=this.container.offsetParent?this.container.offsetHeight:x.getHiddenElementOuterHeight(this.container),a=x.getViewport();e+l-document.body.scrollLeft>a.width&&(e-=l),n+s-document.body.scrollTop>a.height&&(n-=s),e<document.body.scrollLeft&&(e=document.body.scrollLeft),n<document.body.scrollTop&&(n=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=n+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:X}};function pe(e,n,l,s,a,t){const r=O("ContextMenuSub");return o(),c(ee,{to:l.appendTo},[u(Z,{name:"p-contextmenu",onEnter:t.onEnter,onLeave:t.onLeave,onAfterLeave:t.onAfterLeave},{default:v(()=>[a.visible?(o(),c("div",G({key:0,ref:t.containerRef,class:t.containerClass},e.$attrs),[u(r,{model:l.model,root:!0,onLeafClick:t.onLeafClick,template:e.$slots.item,exact:l.exact},null,8,["model","onLeafClick","template","exact"])],16)):k("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function me(e,n){n===void 0&&(n={});var l=n.insertAt;if(!(!e||typeof document=="undefined")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",l==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var he=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;me(he);Y.render=pe;const fe={class:"block text-lg"},K=z({props:{editable:null,placeholder:null},emits:["update"],setup(e,{emit:n}){const s=_(e.editable),a=_(),t=()=>{a.value.close(),n("update",s.value||"")};return(r,m)=>{const p=R("focus");return o(),c(h(P),{ref_key:"edit",ref:a,closable:!1,class:te([s.value?"":"text-slate-400"])},{display:v(()=>[d("h2",fe,T(s.value||e.placeholder||"Klicken zum Bearbeiten"),1)]),content:v(()=>[M(u(h(H),{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=i=>s.value=i),class:"text-lg","aria-label":"Eigenschaft \xE4ndern",onKeyup:V(t,["enter"]),onBlur:t},null,8,["modelValue","onKeyup"]),[[p]])]),_:1},8,["class"])}}}),ve={open:""},be={class:"text-lg relative"},xe={class:"edit"},ye=d("div",null,null,-1),ke=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," more_vert ",-1),_e=z({props:{step:null},emits:["addStep","duplicateStep","deleteStep","updateStep"],setup(e,{emit:n}){const l=e,s=_(),a=[{label:"Neue Frage",command:()=>n("addStep")},{label:"Frage duplizieren",command:()=>n("duplicateStep")},{label:"Frage l\xF6schen",command:()=>n("deleteStep")}],t=p=>{s.value.show(p)},r=p=>{const i=l.step;i.prompt=p,n("updateStep",i)},m=p=>{const i=l.step;i.description=p,n("updateStep",i)};return(p,i)=>(o(),C("details",ve,[d("summary",be,[d("header",xe,[u(K,{editable:e.step.prompt,onUpdate:r},null,8,["editable"]),ye,u(K,{editable:e.step.description,placeholder:"Erkl\xE4rungstext (optional)",onUpdate:m},null,8,["editable"]),u(h(w),{type:"button",class:"absolute top-0 right-0","aria-label":"menu","aria-haspopup":"menu",onContextmenu:t,onClick:t,onKeypress:V(t,["m"])},{default:v(()=>[ke]),_:1},8,["onKeypress"]),u(h(Y),{ref_key:"menu",ref:s,model:a},null,512)])])]))}}),ge={class:"flex h-full"},Ce={class:"flex-none"},Le={class:"flex-1 px-8"},Se={class:"edit"},Ie=d("p",null,[d("small",null,"Modul")],-1),Ee={class:"font-bold text-xl"},we=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," edit ",-1),Me=$(" \xC4ndern "),Te=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," delete ",-1),ze=$(" Modul l\xF6schen "),Ae={class:"mt-16"},De=d("h2",{class:"font-bold text-lg"},"Fragen",-1),Be={key:0},Fe=d("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," add ",-1),Ne=$(" Neue Frage "),Oe={key:2},Re=z({props:{playbookId:null,moduleId:null},setup(e){const n=e,l=ne(),s=le(),a=ae(),t=_(s.findById(n.playbookId)),r=_(t.value.findModuleById(n.moduleId)),m=_(r.value.title),p=_(),i=()=>{p.value.open()},L=()=>{r.value.title=m.value,p.value.close(),s.save(t.value)},y=()=>{a.save(t.value)},A=async f=>{await l.push(`/mitra-frontend/playbook/${t.value.id}/module/${f.id}/`)},D=async()=>{t.value.removeModule(r.value),s.save(t.value),await l.push(`/mitra-frontend/playbook/${t.value.id}/`)},S=f=>{f?r.value.addStep(new U("Neue Frage"),f):r.value.addStep(new U("Neue Frage")),s.save(t.value)},B=f=>{r.value.duplicateStep(f),s.save(t.value)},j=f=>{r.value.removeStep(f),s.save(t.value)},q=(f,g)=>{const F=r.value.steps.indexOf(f);r.value.steps[F]=g,s.save(t.value)};return(f,g)=>{const F=R("focus");return o(),C("div",ge,[d("nav",Ce,[u(se,{title:h(t).title,navigatable:h(t),onSave:y,onNavigate:A},null,8,["title","navigatable"])]),d("main",Le,[d("header",Se,[u(oe,{"current-title":m.value,"parent-items":[h(t)]},null,8,["current-title","parent-items"]),Ie,u(h(P),{ref_key:"editTitle",ref:p,closable:!1},{display:v(()=>[d("h1",Ee,T(m.value),1)]),content:v(()=>[M(u(h(H),{modelValue:m.value,"onUpdate:modelValue":g[0]||(g[0]=b=>m.value=b),class:"mr-1","aria-label":"Titel \xE4ndern",onKeyup:V(L,["enter"]),onBlur:L},null,8,["modelValue","onKeyup"]),[[F]])]),_:1},512),u(h(w),{type:"button",class:"mx-2",onClick:i},{default:v(()=>[we,Me]),_:1}),u(h(w),{type:"button",onClick:D},{default:v(()=>[Te,ze]),_:1})]),d("section",Ae,[De,r.value.steps.length===0?(o(),C("p",Be," F\xFCr dieses Modul wurden noch keine Fragen erstellt. ")):k("",!0),r.value.steps.length===0?(o(),c(h(w),{key:1,type:"button",class:"mt-8",onClick:g[1]||(g[1]=b=>S())},{default:v(()=>[Fe,Ne]),_:1})):(o(),C("ol",Oe,[(o(!0),C(E,null,W(r.value.steps,(b,J)=>(o(),C("li",{key:b.id,class:"mt-4 border p-4 shadow-md"},[u(_e,{step:b,onAddStep:I=>S(J+1),onDeleteStep:I=>j(b),onDuplicateStep:I=>B(b),onUpdateStep:I=>q(b,I)},null,8,["step","onAddStep","onDeleteStep","onDuplicateStep","onUpdateStep"])]))),128))]))])])])}}}),Xe=z({props:{playbookId:null,moduleId:null},setup(e){return(n,l)=>(o(),c(Re,{key:e.moduleId,"playbook-id":e.playbookId,"module-id":e.moduleId},null,8,["playbook-id","module-id"]))}});export{Xe as default};
