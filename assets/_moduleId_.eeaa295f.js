import{Z as z,I as h,r as B,K as O,o as a,c as r,w as m,F as S,q as R,L as D,i as u,t as w,l as x,M as P,N as j,n as X,T as U,f as F,p as C,g as _,h as c,Y as V,u as p,a6 as q,j as N}from"./vendor.301f9710.js";import{R as G,s as E}from"./button.esm.beac9337.js";import{_ as J,b as Q,s as ee}from"./SideMenu.803f66ad.js";import{c as te,T as W,d as ne}from"./provide.9f023922.js";import{_ as ie}from"./Breadcrumb.40585c04.js";import"./session.51340ef0.js";import"./main.2d45b030.js";var Z={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,t){if(this.disabled(t)){e.preventDefault();return}this.activeItem=t},onItemClick(e,t,s){if(this.disabled(t)){e.preventDefault();return}t.command&&t.command({originalEvent:e,item:t}),t.items&&(this.activeItem&&t===this.activeItem?this.activeItem=null:this.activeItem=t),t.items||this.onLeafClick(),t.to&&s&&s(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,t=h.getOffset(this.$refs.container.parentElement),s=h.getViewport(),o=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:h.getHiddenElementOuterWidth(this.$refs.container),l=h.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(t.left,10)+l+o>s.width-h.calculateScrollbarWidth()?this.$refs.container.style.left=-1*o+"px":this.$refs.container.style.left=l+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:G}};const se={class:"p-menuitem-text"},le={class:"p-menuitem-text"},ae={key:0,class:"p-submenu-icon pi pi-angle-right"};function oe(e,t,s,o,l,n){const d=B("router-link"),f=B("ContextMenuSub",!0),y=O("ripple");return a(),r(j,{name:"p-contextmenusub",onEnter:n.onEnter},{default:m(()=>[(s.root?!0:s.parentActive)?(a(),r("ul",{key:0,ref:"container",class:n.containerClass,role:"menu"},[(a(!0),r(S,null,R(s.model,(i,g)=>(a(),r(S,{key:n.label(i)+g.toString()},[n.visible(i)&&!i.separator?(a(),r("li",{key:0,role:"none",class:n.getItemClass(i),style:i.style,onMouseenter:b=>n.onItemMouseEnter(b,i)},[s.template?(a(),r(P(s.template),{key:1,item:i},null,8,["item"])):(a(),r(S,{key:0},[i.to&&!n.disabled(i)?(a(),r(d,{key:0,to:i.to,custom:""},{default:m(({navigate:b,href:M,isActive:T,isExactActive:L})=>[D(u("a",{href:M,onClick:A=>n.onItemClick(A,i,b),class:n.linkClass(i,{isActive:T,isExactActive:L}),role:"menuitem"},[u("span",{class:["p-menuitem-icon",i.icon]},null,2),u("span",se,w(n.label(i)),1)],10,["href","onClick"]),[[y]])]),_:2},1032,["to"])):D((a(),r("a",{key:1,href:i.url,class:n.linkClass(i),target:i.target,onClick:b=>n.onItemClick(b,i),"aria-haspopup":i.items!=null,"aria-expanded":i===l.activeItem,role:"menuitem",tabindex:n.disabled(i)?null:"0"},[u("span",{class:["p-menuitem-icon",i.icon]},null,2),u("span",le,w(n.label(i)),1),i.items?(a(),r("span",ae)):x("",!0)],10,["href","target","onClick","aria-haspopup","aria-expanded","tabindex"])),[[y]])],64)),n.visible(i)&&i.items?(a(),r(f,{model:i.items,key:n.label(i)+"_sub_",template:s.template,onLeafClick:n.onLeafClick,parentActive:i===l.activeItem,exact:s.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):x("",!0)],46,["onMouseenter"])):x("",!0),n.visible(i)&&i.separator?(a(),r("li",{class:["p-menu-separator",i.class],style:i.style,key:"separator"+g.toString(),role:"separator"},null,6)):x("",!0)],64))),128))],2)):x("",!0)]),_:1},8,["onEnter"])}Z.render=oe;var K={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&z.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const t=e.item;t.command&&(t.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&z.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&z.clear(e)},position(){let e=this.pageX+1,t=this.pageY+1,s=this.container.offsetParent?this.container.offsetWidth:h.getHiddenElementOuterWidth(this.container),o=this.container.offsetParent?this.container.offsetHeight:h.getHiddenElementOuterHeight(this.container),l=h.getViewport();e+s-document.body.scrollLeft>l.width&&(e-=s),t+o-document.body.scrollTop>l.height&&(t-=o),e<document.body.scrollLeft&&(e=document.body.scrollLeft),t<document.body.scrollTop&&(t=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=t+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:Z}};function re(e,t,s,o,l,n){const d=B("ContextMenuSub");return a(),r(U,{to:s.appendTo},[u(j,{name:"p-contextmenu",onEnter:n.onEnter,onLeave:n.onLeave,onAfterLeave:n.onAfterLeave},{default:m(()=>[l.visible?(a(),r("div",X({key:0,ref:n.containerRef,class:n.containerClass},e.$attrs),[u(d,{model:s.model,root:!0,onLeafClick:n.onLeafClick,template:e.$slots.item,exact:s.exact},null,8,["model","onLeafClick","template","exact"])],16)):x("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function ue(e,t){t===void 0&&(t={});var s=t.insertAt;if(!(!e||typeof document=="undefined")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",s==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var ce=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;ue(ce);K.render=re;const de={open:""},pe={class:"text-lg relative"},me=c("span",{class:"text-slate-400"},"Erkl\xE4rungstext (optional)",-1),he=c("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," more_vert ",-1),fe=F({props:{step:null},emits:["addStep","deleteStep"],setup(e,{emit:t}){const s=C(),o=[{label:"Neue Frage",command:()=>t("addStep")},{label:"Frage duplizieren"},{label:"Frage l\xF6schen",command:()=>t("deleteStep")}],l=n=>{console.log(s.value),s.value.show(n)};return(n,d)=>(a(),_("details",de,[c("summary",pe,[c("h3",null,w(e.step.text),1),me,u(p(E),{type:"button",class:"absolute top-0 right-0","aria-label":"menu","aria-haspopup":"menu",onContextmenu:l,onClick:l,onKeypress:V(l,["m"])},{default:m(()=>[he]),_:1},8,["onKeypress"]),u(p(K),{ref_key:"menu",ref:s,model:o},null,512)])]))}}),be={class:"flex h-full"},ve={class:"flex-none"},xe={class:"flex-1 px-8"},ye={class:"edit"},ke=c("p",null,[c("small",null,"Modul")],-1),_e={class:"font-bold text-xl"},ge=c("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," edit ",-1),Ce=N(" \xC4ndern "),Le=c("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," delete ",-1),Ie=N(" Modul l\xF6schen "),Se={class:"mt-16"},we=c("h2",{class:"font-bold text-lg"},"Fragen",-1),Ee={key:0},Me=c("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," add ",-1),Te=N(" Neue Frage "),Ae={key:2},ze=F({props:{playbookId:null,moduleId:null},setup(e){const t=e,s=q(),o=te(),l=ne();let n=C(o.findById(t.playbookId)),d=C(n.value.findModuleById(t.moduleId));const f=C(d.value.title),y=C(),i=()=>{y.value.open()},g=()=>{d.value.title=f.value,y.value.close(),o.save(n.value)},b=()=>{l.save(n.value)},M=async v=>{await s.push(`/mitra-frontend/playbook/${n.value.id}/module/${v.id}/`)},T=async()=>{n.value.removeModule(d.value),o.save(n.value),await s.push(`/mitra-frontend/playbook/${n.value.id}/`)},L=v=>{v?d.value.addStep(new W("Neue Frage"),v):d.value.addStep(new W("Neue Frage")),o.save(n.value)},A=v=>{d.value.removeStep(v),o.save(n.value)};return(v,I)=>{const $=O("focus");return a(),_("div",be,[c("nav",ve,[u(J,{title:p(n).title,navigatable:p(n),onSave:b,onNavigate:M},null,8,["title","navigatable"])]),c("main",xe,[c("header",ye,[u(ie,{"current-title":f.value,"parent-items":[p(n)]},null,8,["current-title","parent-items"]),ke,u(p(Q),{ref_key:"editTitle",ref:y,closable:!1},{display:m(()=>[c("h1",_e,w(f.value),1)]),content:m(()=>[D(u(p(ee),{modelValue:f.value,"onUpdate:modelValue":I[0]||(I[0]=k=>f.value=k),class:"mr-1","aria-label":"Titel \xE4ndern",onKeyup:V(g,["enter"]),onBlur:g},null,8,["modelValue","onKeyup"]),[[$]])]),_:1},512),u(p(E),{type:"button",class:"mx-2",onClick:i},{default:m(()=>[ge,Ce]),_:1}),u(p(E),{type:"button",onClick:T},{default:m(()=>[Le,Ie]),_:1})]),c("section",Se,[we,p(d).steps.length===0?(a(),_("p",Ee," F\xFCr dieses Modul wurden noch keine Fragen erstellt. ")):x("",!0),p(d).steps.length===0?(a(),r(p(E),{key:1,type:"button",class:"mt-8",onClick:I[1]||(I[1]=k=>L())},{default:m(()=>[Me,Te]),_:1})):(a(),_("ol",Ae,[(a(!0),_(S,null,R(p(d).steps,(k,H)=>(a(),_("li",{key:k.id,class:"mt-4 border p-4 shadow-md"},[u(fe,{step:k,onAddStep:Y=>L(H+1),onDeleteStep:Y=>A(k)},null,8,["step","onAddStep","onDeleteStep"])]))),128))]))])])])}}}),Ve=F({props:{playbookId:null,moduleId:null},setup(e){return(t,s)=>(a(),r(ze,{key:e.moduleId,"playbook-id":e.playbookId,"module-id":e.moduleId},null,8,["playbook-id","module-id"]))}});export{Ve as default};
