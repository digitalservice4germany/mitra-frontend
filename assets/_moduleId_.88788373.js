import{R as Y,s as z}from"./button.esm.dd40cd4e.js";import{Z as A,I as y,r as D,K as P,o as a,c as h,w as L,F as M,s as $,L as R,j as m,t as F,m as g,M as X,N as W,p as j,T as q,f as N,q as w,g as C,h as p,k as B,W as G,u as f,X as U,a8 as J}from"./vendor.4eaa413b.js";import{R as V,T,u as Q}from"./session.a26a97f0.js";import{b as ee}from"./provide.26d50acb.js";import{_ as te}from"./Breadcrumb.bdc4cced.js";import{b as O,_ as ne}from"./SideMenu.1fe69dc1.js";import{s as ie}from"./dropdown.esm.43b56f3e.js";import"./main.b94c9f5d.js";var Z={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,t){if(this.disabled(t)){e.preventDefault();return}this.activeItem=t},onItemClick(e,t,i){if(this.disabled(t)){e.preventDefault();return}t.command&&t.command({originalEvent:e,item:t}),t.items&&(this.activeItem&&t===this.activeItem?this.activeItem=null:this.activeItem=t),t.items||this.onLeafClick(),t.to&&i&&i(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,t=y.getOffset(this.$refs.container.parentElement),i=y.getViewport(),r=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:y.getHiddenElementOuterWidth(this.$refs.container),l=y.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(t.left,10)+l+r>i.width-y.calculateScrollbarWidth()?this.$refs.container.style.left=-1*r+"px":this.$refs.container.style.left=l+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:Y}};const se={class:"p-menuitem-text"},le={class:"p-menuitem-text"},ae={key:0,class:"p-submenu-icon pi pi-angle-right"};function oe(e,t,i,r,l,n){const o=D("router-link"),x=D("ContextMenuSub",!0),k=P("ripple");return a(),h(W,{name:"p-contextmenusub",onEnter:n.onEnter},{default:L(()=>[(i.root?!0:i.parentActive)?(a(),h("ul",{key:0,ref:"container",class:n.containerClass,role:"menu"},[(a(!0),h(M,null,$(i.model,(s,_)=>(a(),h(M,{key:n.label(s)+_.toString()},[n.visible(s)&&!s.separator?(a(),h("li",{key:0,role:"none",class:n.getItemClass(s),style:s.style,onMouseenter:b=>n.onItemMouseEnter(b,s)},[i.template?(a(),h(X(i.template),{key:1,item:s},null,8,["item"])):(a(),h(M,{key:0},[s.to&&!n.disabled(s)?(a(),h(o,{key:0,to:s.to,custom:""},{default:L(({navigate:b,href:S,isActive:c,isExactActive:u})=>[R(m("a",{href:S,onClick:d=>n.onItemClick(d,s,b),class:n.linkClass(s,{isActive:c,isExactActive:u}),role:"menuitem"},[m("span",{class:["p-menuitem-icon",s.icon]},null,2),m("span",se,F(n.label(s)),1)],10,["href","onClick"]),[[k]])]),_:2},1032,["to"])):R((a(),h("a",{key:1,href:s.url,class:n.linkClass(s),target:s.target,onClick:b=>n.onItemClick(b,s),"aria-haspopup":s.items!=null,"aria-expanded":s===l.activeItem,role:"menuitem",tabindex:n.disabled(s)?null:"0"},[m("span",{class:["p-menuitem-icon",s.icon]},null,2),m("span",le,F(n.label(s)),1),s.items?(a(),h("span",ae)):g("",!0)],10,["href","target","onClick","aria-haspopup","aria-expanded","tabindex"])),[[k]])],64)),n.visible(s)&&s.items?(a(),h(x,{model:s.items,key:n.label(s)+"_sub_",template:i.template,onLeafClick:n.onLeafClick,parentActive:s===l.activeItem,exact:i.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):g("",!0)],46,["onMouseenter"])):g("",!0),n.visible(s)&&s.separator?(a(),h("li",{class:["p-menu-separator",s.class],style:s.style,key:"separator"+_.toString(),role:"separator"},null,6)):g("",!0)],64))),128))],2)):g("",!0)]),_:1},8,["onEnter"])}Z.render=oe;var K={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&A.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const t=e.item;t.command&&(t.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&A.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&A.clear(e)},position(){let e=this.pageX+1,t=this.pageY+1,i=this.container.offsetParent?this.container.offsetWidth:y.getHiddenElementOuterWidth(this.container),r=this.container.offsetParent?this.container.offsetHeight:y.getHiddenElementOuterHeight(this.container),l=y.getViewport();e+i-document.body.scrollLeft>l.width&&(e-=i),t+r-document.body.scrollTop>l.height&&(t-=r),e<document.body.scrollLeft&&(e=document.body.scrollLeft),t<document.body.scrollTop&&(t=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=t+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:Z}};function re(e,t,i,r,l,n){const o=D("ContextMenuSub");return a(),h(q,{to:i.appendTo},[m(W,{name:"p-contextmenu",onEnter:n.onEnter,onLeave:n.onLeave,onAfterLeave:n.onAfterLeave},{default:L(()=>[l.visible?(a(),h("div",j({key:0,ref:n.containerRef,class:n.containerClass},e.$attrs),[m(o,{model:i.model,root:!0,onLeafClick:n.onLeafClick,template:e.$slots.item,exact:i.exact},null,8,["model","onLeafClick","template","exact"])],16)):g("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function ue(e,t){t===void 0&&(t={});var i=t.insertAt;if(!(!e||typeof document=="undefined")){var r=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",i==="top"&&r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var de=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;ue(de);K.render=re;const ce=["open"],pe={class:"text-lg relative"},me={class:"edit"},he={class:"antworttyp text-base my-2 ml-3"},fe=p("header",{class:"text-slate-400"},"Antworttyp",-1),be=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," more_vert ",-1),ve={class:"relative edit"},ye={class:"mb-2"},xe=N({props:{step:null},emits:["addStep","duplicateStep","deleteStep","updateStep"],setup(e,{emit:t}){const i=e;let r=w({visible:!1,open(){this.visible=!0},close(){this.visible=!1}});const l=w(),n=[{label:"Neue Frage",command:()=>t("addStep")},{label:"Frage duplizieren",command:()=>t("duplicateStep")},{label:"Frage l\xF6schen",command:()=>t("deleteStep")}],o=c=>{l.value.show(c)},x={TextAnswerStep:"Kurzer Text",RichTextAnswerStep:"Langer Text"},k=Object.keys(x).map(c=>({modelValue:c,name:x[c]})),s=w(k.find(c=>c.modelValue===i.step.type)),_=c=>{t("updateStep",(()=>{const u=c.value.modelValue;if(u===V.TYPE)return new V(i.step.prompt,{description:i.step.description,id:i.step.id});if(u===T.TYPE)return new T(i.step.prompt,{description:i.step.description,id:i.step.id});throw new Error("Unknown step type")})())},b=c=>{const u=i.step;u.prompt=c,t("updateStep",u)},S=c=>{const u=i.step;u.description=c,t("updateStep",u)};return(c,u)=>(a(),C("details",{open:f(r).visible,onKeyup:u[1]||(u[1]=U(()=>{},["prevent"])),onClick:u[2]||(u[2]=U((...d)=>f(r).open&&f(r).open(...d),["prevent"]))},[p("summary",pe,[p("header",me,[m(O,{editable:e.step.prompt,h1:"",onUpdate:b},null,8,["editable"]),p("div",he,[fe,B(" "+F(x[e.step.type]),1)]),m(f(z),{type:"button",class:"absolute top-0 right-0","aria-label":"menu","aria-haspopup":"menu",onContextmenu:o,onClick:o,onKeypress:G(o,["m"])},{default:L(()=>[be]),_:1},8,["onKeypress"]),m(f(K),{ref_key:"menu",ref:l,model:n},null,512)])]),p("div",ve,[p("div",ye,[m(O,{editable:e.step.description,placeholder:"Erkl\xE4rungstext (optional)",onUpdate:S},null,8,["editable"])]),p("div",null,[m(f(ie),{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value=d),options:f(k),"option-label":"name",class:"ml-3","aria-label":"Fragentyp",placeholder:"Fragentyp ausw\xE4hlen",onChange:_},null,8,["modelValue","options"])])])],40,ce))}}),ke={class:"flex h-full"},ge={class:"flex-none"},_e={class:"flex-1 px-8"},Ce={class:"edit"},Le=p("p",null,[p("small",null,"Modul")],-1),Se=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," delete ",-1),we=B(" Modul l\xF6schen "),Ie={class:"mt-16"},Ee=p("h2",{class:"font-bold text-lg"},"Fragen",-1),Me={key:0},Te=p("span",{class:"material-icons-outlined text-base","aria-hidden":"true"}," add ",-1),Ae=B(" Neue Frage "),ze={key:2},De=N({props:{playbookId:null,moduleId:null},setup(e){const t=e,i=Q(),r=J(),l=ee(),n=w(i.playbook),o=w(n.value.findModuleById(t.moduleId)),x=d=>{o.value.title=d,i.refresh({playbook:n.value})},k=()=>{l.save(n.value)},s=async d=>{await r.push(`/mitra-frontend/playbook/${n.value.id}/module/${d.id}/`)},_=async()=>{n.value.removeModule(o.value),i.refresh({playbook:n.value}),await r.push(`/mitra-frontend/playbook/${n.value.id}/`)},b=d=>{d?o.value.addStep(new T("Neue Frage"),d):o.value.addStep(new T("Neue Frage")),i.refresh({playbook:n.value})},S=d=>{o.value.duplicateStep(d),i.refresh({playbook:n.value})},c=d=>{o.value.removeStep(d),i.refresh({playbook:n.value})},u=(d,I)=>{const v=o.value.steps.indexOf(d);o.value.steps[v]=I,i.refresh({playbook:n.value})};return(d,I)=>(a(),C("div",ke,[p("nav",ge,[m(ne,{title:f(n).title,navigatable:f(n),onSave:k,onNavigate:s},null,8,["title","navigatable"])]),p("main",_e,[p("header",Ce,[m(te,{"current-title":o.value.title,"parent-items":[f(n)]},null,8,["current-title","parent-items"]),Le,m(O,{editable:o.value.title,h1:"",button:"",onUpdate:x},null,8,["editable"]),m(f(z),{type:"button",class:"inline-flex align-top",onClick:_},{default:L(()=>[Se,we]),_:1})]),p("section",Ie,[Ee,o.value.steps.length===0?(a(),C("p",Me," F\xFCr dieses Modul wurden noch keine Fragen erstellt. ")):g("",!0),o.value.steps.length===0?(a(),h(f(z),{key:1,type:"button",class:"mt-8",onClick:I[0]||(I[0]=v=>b())},{default:L(()=>[Te,Ae]),_:1})):(a(),C("ol",ze,[(a(!0),C(M,null,$(o.value.steps,(v,H)=>(a(),C("li",{key:v.id,class:"mt-4 border p-4 shadow-md"},[m(xe,{step:v,onAddStep:E=>b(H+1),onDeleteStep:E=>c(v),onDuplicateStep:E=>S(v),onUpdateStep:E=>u(v,E)},null,8,["step","onAddStep","onDeleteStep","onDuplicateStep","onUpdateStep"])]))),128))]))])])]))}}),We=N({props:{playbookId:null,moduleId:null},setup(e){return(t,i)=>(a(),h(De,{key:e.moduleId,"playbook-id":e.playbookId,"module-id":e.moduleId},null,8,["playbook-id","module-id"]))}});export{We as default};
